FROM ubuntu:hirsute

ENV HOME /root
ENV DEBIAN_FRONTEND "noninteractive"

RUN apt-get update -y && apt-get upgrade -y && \
    apt-get -y install \
        build-essential \
        git \
        apt-utils \
        software-properties-common \
        cmake \
        gfortran \
        gcc-11 \
        g++-11 \
        clang \
        liblapack-dev \
        libblas-dev \
        libsuitesparse-dev \
        libdune-common-dev \
        libdune-geometry-dev \
        libdune-grid-dev \
        libspdlog-dev \
        libbenchmark-dev \
        libeigen3-dev \
        libgtest-dev && \
        cd /usr/src/googletest && \
        cmake . && \
        cmake --build . --target install && \
        git clone https://github.com/alandefreitas/matplotplusplus.git && \
        mkdir -p build && \
        cd build && \
        cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_CXX_FLAGS="-O2" -DBUILD_EXAMPLES=OFF -DBUILD_TESTS=OFF && \
        cmake --build . --parallel 4 --config Release && \
        cmake --install . && \
        cd .. && \
        rm -r build && \
        rm -r matplotplusplus && \
CMD [ "/bin/bash" ]

WORKDIR $HOME