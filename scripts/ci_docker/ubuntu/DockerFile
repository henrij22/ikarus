FROM ubuntu:hirsute

ENV HOME /root
ENV DEBIAN_FRONTEND "noninteractive"

RUN apt-get update -y && apt-get upgrade -y && \
    apt-get -y install \
        build-essential \
        libssl-dev \
        git \
        wget \
        apt-utils \
        software-properties-common \
        gfortran \
        gcc-11 \
        g++-11 \
        clang \
        liblapack-dev \
        libblas-dev \
        libsuitesparse-dev \
        libdune-common-dev \
        libdune-geometry-dev \
        libdune-grid-dev \
        libspdlog-dev \
        libbenchmark-dev \
        libeigen3-dev \
        libgtest-dev && \
        wget https://github.com/Kitware/CMake/releases/download/v3.20.5/cmake-3.20.5-linux-x86_64.tar.gz && \
        tar -zxvf cmake-3.20.5-linux-x86_64.tar.gz && \
        cd cmake-3.20.5-linux-x86_64 && \
        ./bootstrap && \
        make && \
        make install && \
        rm -r cmake-3.20.5-linux-x86_64 && \
        cd /usr/src/googletest && \
        cmake . && \
        cmake --build . --target install && \
        cd ~/ && \
        git clone https://github.com/alandefreitas/matplotplusplus.git && \
        cd matplotplusplus && \
        mkdir -p build && \
        cd build && \
        cmake .. -DCMAKE_BUILD_TYPE=Release -DBUILD_EXAMPLES=OFF -DBUILD_TESTS=OFF && \
        cmake --build . --parallel 4 --config Release && \
        cmake --install . && \
        cd ../.. && \
        rm -r matplotplusplus
CMD [ "/bin/bash" ]

WORKDIR $HOME